<!DOCTYPE html>  <html> <head>   <title>OO.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               OO.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><strong>A few simple helper methods to help you do object-oriented javascript</strong></p>

<p><em>Author</em>: Arjan van der Gaag <br />
<em>URL</em>: <a href="http://avdgaag.github.com/oo">http://avdgaag.github.com/oo</a> <br />
<em>License</em>: MIT license <br />
<em>Version</em>: 0.1.0</p>

<hr />

<h2>Installation</h2>

<p>Simple include the script on your page:</p>

<pre><code>&lt;script src="oo.js"&gt;&lt;/script&gt;
</code></pre>

<p>...or <code>require</code> it in your node.js project:</p>

<pre><code>var OO = require('oo.js');
</code></pre>

<p>This library is not yet published as an NPM package, but you can download it
manually and install it yourself if you want to using <code>npm install</code>. Once I
can think of a better name, I might release it as a package.</p>

<h2>Usage example</h2>

<pre><code>var Parent = (function() {
    function Parent(foo) {
        this.foo = foo;
        this.getFoo = OO.bind(this, this.getFoo);
    }
    Parent.prototype.getFoo = function() {
        return this.foo;
    };
    return Parent;
})();

var Module = {
    getBar: function() {
        return this.bar;
    }
};

var Child = (function() {
    OO.inherits(Child, Parent);
    OO.include(Child, Module);
    function Child(foo, bar) {
        Child.__super__.constructor.call(this, foo);
        this.bar = bar;
    }
    Child.prototype.getFoo = function() {
        return Child.__super__.getFoo.call(this) + '!';
    };
})();
</code></pre>

<p>Use properties like normal, even those that are set using the
parent's constructor function:</p>

<pre><code>var c = new Child('a', 'b');
c.foo; // =&gt; 'a'
c.bar; // =&gt; 'b'
</code></pre>

<p>Note how the child object decorates the parent object:</p>

<pre><code>c.getFoo(); // =&gt; 'a!'
</code></pre>

<p>Also note that a method can be bound to an object:</p>

<pre><code>c.getFoo.call({ foo: 'c' }); // =&gt; 'a!'
</code></pre>

<p>Finally, we have mixed in a module, so its properties become available:</p>

<pre><code>c.getBar(); // =&gt; 'b'
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">OO</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h3>Generics</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Publish the current version of the library, should you ever
need it at runtime.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">version</span><span class="o">:</span> <span class="s1">&#39;0.1.0&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>OO helper methods</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Extend one object with the properties of another.</p>

<p>This essentially mixes in all properties of <code>guest</code> into <code>host</code>,
which is not only great for merging hashes but also allowing objects
to include modules.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">extend</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">guest</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">guest</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">guest</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">host</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">guest</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Include a module into this class</p>

<p>This is a variety of extend that works on an objects <code>prototype</code>
property rather than the object itself. The following are
equivalent:</p>

<pre><code>extend(Host.prototype, Module);
include(Host, Module);
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">include</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">host</span><span class="p">,</span> <span class="nx">guest</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">guest</span><span class="p">);</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Simulate inheritence of one object (<code>child</code>) from another (<code>parent</code>).</p>

<p>This creates a <em>ghost-class</em> that shares its prototype with the
parent, and an instanceof which acts as prototype for the child.
This allows the child to share the prototype properties of the
parent, without being able to modify them directly (we don't want
them to be <em>the same</em> properties).</p>

<p>Furthermore, this extends the child constructor itself with any
properties of the parent constructor, and it sets a <code>__super__</code>
property that allows access to the parent functions, enabling the
child to decorate its parent's functions.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">inherits</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">parent</span><span class="p">);</span>
            <span class="kd">function</span> <span class="nx">Ghost</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span> <span class="p">}</span>
            <span class="nx">Ghost</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
            <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ghost</span><span class="p">;</span>
            <span class="nx">child</span><span class="p">.</span><span class="nx">__super__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Bind a function to a particular context.</p>

<p>Being able to dynamically set the execution context of a function
using <code>call</code> or <code>apply</code> is really handy, but when your functions are
assumed to be method objects, they really need to maintain access to
their object's state. Using <code>bind</code> you can force a context on a
function.</p>

<p>Example:</p>

<pre><code>var obj = {
  foo: 'bar',
  speak: function() { return this.foo; }
};
obj.speak(); // =&gt; 'bar'
obj.speak.call({ foo: 'qux' }) // =&gt; 'qux'
obj.speak = bind(obj, obj.speak);
obj.speak.call({ foo: 'qux' }) // =&gt; 'bar'
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">bind</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="p">};</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h3>Observable</h3>

<p>Observable is a really simple mixin implementing the observer pattern,
allowing arbitrary observers to attach themselves to an object and
be notified of events that occur in that object.</p>

<p>You can include the Observable behaviour in your own objects by mixing
it in:</p>

<pre><code>var obj = {};
OO.extend(obj, OO.Observable);
</code></pre>

<p>Or, when using the class pattern, include it in every instance:</p>

<pre><code>var Obj = (function() {
  OO.include(Obj, OO.Observable);

  function Obj() {
  }

  return Obj;
});
</code></pre>

<p>Once mixed in, your object can use the <code>trigger</code> function to notify all
observers of a particular event -- passing along any extra arguments.
Observers can register callback functions for named events using <code>on</code> or
remove callback functions using <code>off</code>.</p>

<p>The internal list of callback functions is stored in the <code>_callbacks</code> property.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">Observable</span><span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Bind a callback function to a given event on this object</p>

<p>Example:</p>

<pre><code>var my_callback = function() {
  console.log('The object has been initialized');
};
my_object.on('initialize', my_callback);
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">on</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">callbacks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_callbacks</span>  <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_callbacks</span> <span class="o">=</span> <span class="p">{}),</span>
                    <span class="nx">list</span>      <span class="o">=</span> <span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]);</span>
                <span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Remove a callback function from the list of event handlers of
this object.</p>

<p>When not given a particular event name, all observers will be
removed. When not given a particular callback function, all 
callback functions will be removed.</p>

<p>Example:</p>

<pre><code>my_object.off('initialize', my_callback);
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">off</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">callbacks</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_callbacks</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">callbacks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_callbacks</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">delete</span> <span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">];</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">splice</span><span class="p">(</span><span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">callback</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Invoke all observers of this object for the given event name</p>

<p>Any extra arguments passed to <code>trigger</code> will be passed on to the
callback function.</p>

<p>Example:</p>

<pre><code>var obj = {
  change: function() {
    this.trigger('change', 'Hello, world!');
  }
};
obj.on('change', function(msg) {
  alert(msg);
};
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">trigger</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">callbacks</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">args</span><span class="p">;</span>
                <span class="k">if</span><span class="p">((</span><span class="nx">callbacks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_callbacks</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">list</span> <span class="o">=</span> <span class="nx">callbacks</span><span class="p">[</span><span class="nx">event</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="o">++</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">));</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h3>Exporting to gobal object</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Make the OO object available on the window object -- the global
object when running inside a browser -- or as an export, so you
can use it as a CommonJS module.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">module</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="o">!</span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">OO</span> <span class="o">=</span> <span class="nx">OO</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">OO</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">})();</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 